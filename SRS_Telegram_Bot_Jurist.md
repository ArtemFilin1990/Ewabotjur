# SRS / –¢–ó: Telegram-–±–æ—Ç ¬´–Æ—Ä–∏—Å—Ç¬ª (–µ–¥–∏–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç)

## 0) –†–µ—à–µ–Ω–∏–µ
–î–µ–ª–∞–µ–º Telegram-–±–æ—Ç–∞ —Å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º prompt-router –Ω–∞ 9 –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–º—Ç–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –ø–∞–º—è—Ç—å—é —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π DaData –∏ –±–∞–∑–æ–≤—ã–º —Å–∫–æ—Ä–∏–Ω–≥–æ–º –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞.

---

## 1) –¶–µ–ª—å –∏ –≥—Ä–∞–Ω–∏—Ü—ã
–¶–µ–ª—å: –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∞—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø–æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–º—Ç–∞–º, –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–∞–π–ª—ã, –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–µ–∫—Å—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏/–∏–ª–∏ —Ñ–∞–π–ª, –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ DaData –∏ –≤—ã–¥–∞–≤–∞—Ç—å —Å–∫–æ—Ä–∏–Ω–≥.

–í–Ω–µ —Ä–∞–º–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å—É–¥–µ–±–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å—Ö–æ–¥–∞.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–∞—á–∞ –≤ —Å—É–¥/–≥–æ—Å-—Å–∏—Å—Ç–µ–º—ã.
- –°–ª–æ–∂–Ω—ã–π –∫–æ–º–ø–ª–∞–µ–Ω—Å-—Å–∫–æ—Ä–∏–Ω–≥ (—Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–π –ø–æ –ø–æ–ª—è–º DaData).

---

## 2) –†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø—ã
–†–æ–ª–∏:
- client: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–æ—Ç–∞
- lawyer: –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- admin: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏

–î–æ—Å—Ç—É–ø:
- –†–µ–∂–∏–º public —Å –ª–∏–º–∏—Ç–∞–º–∏ –∏–ª–∏ corporate —Å whitelist TG ID.

---

## 3) –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–º—Ç—ã (–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)
–ë–æ—Ç –æ–±—è–∑–∞–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ—Å–ª–æ–≤–Ω–æ (–±–µ–∑ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) —ç—Ç–∏ 9 –ø—Ä–æ–º—Ç–æ–≤:
1) üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
2) üîç –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–ø–æ—Ä—É
3) ‚úçÔ∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ
4) ‚öñÔ∏è –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É —Å–ø–æ—Ä–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏
5) üì¨ –û—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–µ—Ç–µ–Ω–∑–∏—é
6) üìã –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –¥–µ–ª–æ–≤–∞—è –ø–µ—Ä–µ–ø–∏—Å–∫–∞ ‚Äî —Å–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
7) üß© –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–≥–µ–Ω—Ç –ø–æ –¥–æ–≥–æ–≤–æ—Ä–∞–º –†–§
8) üìë –¢–∞–±–ª–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤
9) üìä –ê–Ω–∞–ª–∏–∑ —Å—É–¥–µ–±–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏

---

## 4) –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
S1. –¢–µ–∫—Å—Ç ‚Üí Router ‚Üí (—É—Ç–æ—á–Ω–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç
S2. –§–∞–π–ª ‚Üí Extract ‚Üí Router ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç–∞–±–ª–∏—Ü–∞/–ø–∏—Å—å–º–æ/–¥–æ–∫—É–º–µ–Ω—Ç)
S3. –ò–ù–ù/–û–ì–†–ù ‚Üí DaData ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ ‚Üí —Å–∫–æ—Ä–∏–Ω–≥ ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç
S4. –†—É—á–Ω–æ–π –≤—ã–±–æ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è ‚Üí —Å—Ç—Ä–æ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–º—Ç ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## 5) –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (FR)
FR-1 –ü—Ä–∏—ë–º –∞–ø–¥–µ–π—Ç–æ–≤ Telegram: text, document, photo, callback_query.
FR-2 Router: –≤—ã–±–∏—Ä–∞–µ—Ç 1 –ø—Ä–æ–º—Ç; –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—ë—Ç 1 –ø–∞–∫–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤; –ø—Ä–∏ –Ω–∏–∑–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä.
FR-3 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: —Å–æ–±–ª—é–¥–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç –ø—Ä–æ–º—Ç–∞ (—Ç–∞–±–ª–∏—Ü–∞/–ø–∏—Å—å–º–æ/—Å—Ç—Ä—É–∫—Ç—É—Ä–∞/–∑–∞–∫–ª—é—á–µ–Ω–∏–µ).
FR-4 –§–∞–π–ª—ã –≤—Ö–æ–¥: pdf/docx/txt/md (+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ OCR).
FR-5 –§–∞–π–ª—ã –≤—ã—Ö–æ–¥: md/docx/xlsx (pdf –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
FR-6 DaData: —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ –ò–ù–ù/–û–ì–†–ù/–Ω–∞–∑–≤–∞–Ω–∏—é + –∫—ç—à.
FR-7 –°–∫–æ—Ä–∏–Ω–≥: –Ω–∏–∑–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–≤—ã—Å–æ–∫–∏–π + –ø—Ä–∏—á–∏–Ω—ã.
FR-8 –ü–∞–º—è—Ç—å: users/sessions/documents/outputs + /memory_show /memory_clear + TTL.
FR-9 –ö–æ–º–∞–Ω–¥—ã: /start /help /mode /prompts /status /memory_show /memory_clear /admin.

---

## 6) –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (NFR)
- –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å: —Ä–µ—Ç—Ä–∞–∏ –∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏–π.
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –∫–ª—é—á–∏ –≤ env, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤/—Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–î–Ω –≤ –ª–æ–≥–∞—Ö.
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: —Ç–µ–∫—Å—Ç ‚â§ 20 —Å–µ–∫, —Ñ–∞–π–ª—ã ‚â§ 120 —Å–µ–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç OCR).
- –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å: TTL, –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∏–∑–æ–ª—è—Ü–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

---

## 7) Prompt-router (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
### 7.1 Hard gates (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
1) INN/OGRN + ‚Äú–¥–∞–¥–∞/dadata/—Å–∫–æ—Ä–∏–Ω–≥/—Ä–µ–∫–≤–∏–∑–∏—Ç—ã/–ø—Ä–æ–≤–µ—Ä–∏—Ç—å‚Äù ‚Üí DADATA_CARD
2) ‚Äú—Ç–∞–±–ª–∏—Ü–∞ —Ä–∏—Å–∫–æ–≤‚Äù ‚Üí RISK_TABLE
3) ‚Äú–æ—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–µ—Ç–µ–Ω–∑–∏—é/–ø–æ–ª—É—á–µ–Ω–∞ –ø—Ä–µ—Ç–µ–Ω–∑–∏—è‚Äù ‚Üí CLAIM_REPLY
4) ‚Äú—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ‚Äù ‚Üí LEGAL_OPINION
5) ‚Äú—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞‚Äù ‚Üí CASELAW_ANALYTICS
6) ‚Äú–∫–æ–Ω—Ç—Ä–∞—Ä–≥—É–º–µ–Ω—Ç—ã/–ø–æ–∑–∏—Ü–∏—è –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞/–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–ø–æ—Ä—É‚Äù ‚Üí DISPUTE_PREP
7) ‚Äú—Å–æ—Å—Ç–∞–≤—å/–ø–æ–¥–≥–æ—Ç–æ–≤—å/–ø—Ä–æ–≤–µ—Ä—å –¥–æ–≥–æ–≤–æ—Ä‚Äù ‚Üí CONTRACT_AGENT
8) ‚Äú–ø–∏—Å—å–º–æ/–ø–µ—Ä–µ–ø–∏—Å–∫–∞/email/sms‚Äù (–±–µ–∑ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏/–¥–æ–≥–æ–≤–æ—Ä–∞) ‚Üí BIZ_CORR_CONTEXT
9) ‚Äú—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞‚Äù ‚Üí DOC_STRUCTURE

### 7.2 –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- ‚Äú–ø—Ä–µ—Ç–µ–Ω–∑–∏—è‚Äù + ‚Äú–ø–∏—Å—å–º–æ‚Äù ‚Üí CLAIM_REPLY
- ‚Äú–¥–æ–≥–æ–≤–æ—Ä‚Äù + ‚Äú—Ä–∏—Å–∫–∏‚Äù ‚Üí RISK_TABLE (–µ—Å–ª–∏ —è–≤–Ω–æ ‚Äú—Ä–∏—Å–∫–∏/—Ç–∞–±–ª–∏—Ü–∞‚Äù), –∏–Ω–∞—á–µ CONTRACT_AGENT
- ‚Äú—Å—É–¥–µ–±–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞‚Äù + ‚Äú—Å–ø–æ—Ä‚Äù ‚Üí CASELAW_ANALYTICS –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–µ—Ä–∏–æ–¥–∞, –∏–Ω–∞—á–µ DISPUTE_PREP

### 7.3 Confidence
- scoring –ø–æ –∫–ª—é—á–µ–≤–∏–∫–∞–º/—è–∫–æ—Ä—è–º + –±–æ–Ω—É—Å—ã –∑–∞ —Ñ–∞–π–ª/–ø–µ—Ä–∏–æ–¥ + —à—Ç—Ä–∞—Ñ—ã –∑–∞ missing inputs –∏ –±–ª–∏–∑–∫–∏–µ —Ç–æ–ø-2
- –ø–æ—Ä–æ–≥–∏:
  - >=0.75 ‚Üí RUN_PROMPT (–µ—Å–ª–∏ –Ω–µ—Ç hard gate –Ω–∞ —Ñ–∞–π–ª/–ø–µ—Ä–∏–æ–¥)
  - 0.60‚Äì0.75 ‚Üí ASK_QUESTIONS –∏–ª–∏ RUN_PROMPT + –∫–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
  - <0.60 ‚Üí ASK_QUESTIONS + –∫–Ω–æ–ø–∫–∏ 9 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### 7.4 –ü–∞–∫–µ—Ç—ã –≤–æ–ø—Ä–æ—Å–æ–≤ (1 —Å–æ–æ–±—â–µ–Ω–∏–µ)
–î–ª—è –∫–∞–∂–¥–æ–≥–æ route ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ (—Å–º. —Ä–∞–∑–¥–µ–ª 10).

---

## 8) DTO / JSON-–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
### 8.1 RouteDecision
(—Å–º. —Ä–∞–∑–¥–µ–ª 11 ‚Äî schema)

### 8.2 SessionContext
(—Å–º. —Ä–∞–∑–¥–µ–ª 11 ‚Äî schema)

### 8.3 DocumentArtifact
(—Å–º. —Ä–∞–∑–¥–µ–ª 11 ‚Äî schema)

### 8.4 OutputArtifact
(—Å–º. —Ä–∞–∑–¥–µ–ª 11 ‚Äî schema)

---

## 9) UI Copy –∏ –∫–æ–º–∞–Ω–¥—ã
### 9.1 –ö–æ–º–∞–Ω–¥—ã
/start, /help, /mode, /prompts, /status, /memory_show, /memory_clear, /admin

### 9.2 –°–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–Ω–æ–ø–∫–∏
–ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å: –∫–æ—Ä–æ—Ç–∫–æ, –ø–æ –¥–µ–ª—É, –±–µ–∑ –æ–±–µ—â–∞–Ω–∏–π, –±–µ–∑ ‚Äú—è –¥—É–º–∞—é‚Äù.
- /start: –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞
- /help: –ø—Ä–∏–º–µ—Ä—ã 9 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- low confidence: —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä 9 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- REQUEST_FILE/REQUEST_TIME_RANGE: –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –û—à–∏–±–∫–∏: unsupported/too large/extract failed/timeout/dadata failed

(–ø–æ–ª–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã ‚Äî —Å–º. —Ä–∞–∑–¥–µ–ª 12)

---

## 10) –ü–∞–∫–µ—Ç—ã —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ (–≥–æ—Ç–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã)
–í—Å—Ç–∞–≤–ª—è—Ç—å –∫–∞–∫ –æ–¥–∏–Ω –±–ª–æ–∫, –º–∞–∫—Å–∏–º—É–º 8 –ø—É–Ω–∫—Ç–æ–≤:

- DOC_STRUCTURE: —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Ç–µ–º–∞, —é—Ä–∏—Å–¥–∏–∫—Ü–∏—è, –∞–¥—Ä–µ—Å–∞—Ç, –æ–±—ä—ë–º
- DISPUTE_PREP: —Ç–µ–º–∞—Ç–∏–∫–∞, —Å—Ç–æ—Ä–æ–Ω—ã/—Ä–æ–ª—å, —Ñ–∞–∫—Ç—ã, –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Å—Ç–∞–¥–∏—è, —Ü–µ–ª—å
- LEGAL_OPINION: –≤–æ–ø—Ä–æ—Å, —Ñ–∞–∫—Ç—ã, –æ—Ç—Ä–∞—Å–ª—å, —Ü–µ–ª—å, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è
- CLIENT_EXPLAIN: –¥–µ–π—Å—Ç–≤–∏–µ, –∫–æ–Ω—Ç–µ–∫—Å—Ç, —Ç–æ–Ω, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞, –∫–∞–Ω–∞–ª
- CLAIM_REPLY: –∫–æ–º–ø–∞–Ω–∏—è, –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è/—Å—Ä–æ–∫, –ø–æ–∑–∏—Ü–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Ü–µ–ª—å
- BIZ_CORR_CONTEXT: 8 –≤–æ–ø—Ä–æ—Å–æ–≤ —ç—Ç–∞–ª–æ–Ω–∞
- CONTRACT_AGENT: —Ç–∏–ø, —Å—Ç–æ—Ä–æ–Ω—ã, –ø—Ä–µ–¥–º–µ—Ç, —Ü–µ–Ω–∞, —Å—Ä–æ–∫–∏, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, —Å–ø–æ—Ä—ã, —Ñ–∞–π–ª
- RISK_TABLE: —Ç–∏–ø/—Å—Ç–æ—Ä–æ–Ω—ã, —Ä–æ–ª—å –∫–ª–∏–µ–Ω—Ç–∞, –¥–æ–≥–æ–≤–æ—Ä/–ø—É–Ω–∫—Ç—ã, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ä–∏—Å–∫–æ–≤
- CASELAW_ANALYTICS: –≤–æ–ø—Ä–æ—Å, –ø–µ—Ä–∏–æ–¥, –æ–∫—Ä—É–≥–∞, –Ω–æ–º–µ—Ä–∞ –¥–µ–ª/–≤—ã–¥–µ—Ä–∂–∫–∏, —Ü–µ–ª—å
- DADATA_CARD: –ò–ù–ù/–û–ì–†–ù –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ+—Ä–µ–≥–∏–æ–Ω

---

## 11) JSON Schemas (–≤—Å—Ç–∞–≤–∏—Ç—å –¥–æ—Å–ª–æ–≤–Ω–æ –≤ docs)
### 11.1 RouteDecision
{ ... (–∫–∞–∫ –≤ DTO-—Å–ø–µ–∫–µ) ... }

### 11.2 SessionContext
{ ... }

### 11.3 DocumentArtifact
{ ... }

### 11.4 OutputArtifact
{ ... }

---

## 12) –≠–∫—Å–ø–æ—Ä—Ç –∏ —Ñ–æ—Ä–º–∞—Ç—ã (MD/DOCX/XLSX) + AUTO
### 12.1 –ú–∞—Ç—Ä–∏—Ü–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤
- CONTRACT_AGENT, CLAIM_REPLY ‚Üí DOCX
- RISK_TABLE, DISPUTE_PREP, CASELAW_ANALYTICS ‚Üí XLSX (+ —Ä–µ–∑—é–º–µ)
- LEGAL_OPINION ‚Üí DOCX
- CLIENT_EXPLAIN ‚Üí MSG –∏–ª–∏ DOCX (–ø–æ –æ–±—ä—ë–º—É/–∑–∞–ø—Ä–æ—Å—É)
- DOC_STRUCTURE ‚Üí MSG –∏–ª–∏ MD

### 12.2 AUTO
- FILE –≤—Å–µ–≥–¥–∞: –¥–æ–≥–æ–≤–æ—Ä—ã/–ø—Ä–µ—Ç–µ–Ω–∑–∏–∏/—Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –æ–±—ä—ë–º–µ
- MSG: –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
- –≤—Å–µ–≥–¥–∞: —Ä–µ–∑—é–º–µ –≤ —á–∞—Ç + —Ñ–∞–π–ª –ø—Ä–∏ FILE

### 12.3 –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
YYYY-MM-DD__JURIST__<ROUTE>__<TOPIC_SLUG>__<SID8>.<ext>

---

## 13) –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ API
### 13.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞
src/bot, src/router, src/prompts/canonical, src/files, src/llm, src/integrations, src/storage, src/db, src/domain

### 13.2 API
POST /telegram/webhook
GET /health

---

## 14) –õ–∏–º–∏—Ç—ã –∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
- max_file_size_mb: 20
- max_files_per_request: 3
- max_response_chars_in_chat: 3500
- no file ‚Üí REQUEST_FILE
- no period ‚Üí REQUEST_TIME_RANGE
- scan no text + OCR off ‚Üí NEEDS_OCR

---

## 15) –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ DoD
MVP:
- 9 –ø—Ä–æ–º—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- DOCX/XLSX —ç–∫—Å–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ø–∞–º—è—Ç—å –∏ –æ—á–∏—Å—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- DaData + —Å–∫–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ª–æ–≥–∏ —Å correlation_id

–ë–æ–µ–≤–æ–π:
- override < 10%
- extract fail < 5%
- timeout < 2%
- –ü–î–Ω –≤ –ª–æ–≥–∞—Ö –Ω–µ —É—Ç–µ–∫–ª–∏

---

# 16) Roadmap (MVP ‚Üí v1 ‚Üí v2)

## 16.1 MVP (1‚Äì2 –Ω–µ–¥–µ–ª–∏)
–¶–µ–ª—å: –±–æ—Ç —Ä–µ—à–∞–µ—Ç 9 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ç–µ–∫—Å—Ç–æ–º, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç PDF/DOCX —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º —Å–ª–æ–µ–º, –æ—Ç–¥–∞—ë—Ç DOCX/XLSX, DaData –∫–∞—Ä—Ç–æ—á–∫—É –∏ –±–∞–∑–æ–≤—ã–π —Å–∫–æ—Ä–∏–Ω–≥.

Backlog:
1) Webhook + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ø–¥–µ–π—Ç–æ–≤ Telegram
2) Router rules.ts (hard gates + confidence)
3) Canonical prompts store (/prompts/canonical/*.md)
4) File intake (pdf/docx/txt/md) + extract text
5) LLM client + compose (–∫–∞–Ω–æ–Ω + fill_map + extracted_text)
6) –≠–∫—Å–ø–æ—Ä—Ç: MD, DOCX, XLSX
7) Storage + DB + SessionContext + TTL
8) –ö–æ–º–∞–Ω–¥—ã: /start /help /mode /prompts /memory_clear /status
9) DaData + scoring + –∫—ç—à
10) –õ–æ–≥–∏/health

Acceptance criteria:
- 9 –º–∞—Ä—à—Ä—É—Ç–æ–≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç
- REQUEST_FILE/REQUEST_TIME_RANGE —Ä–∞–±–æ—Ç–∞—é—Ç
- /memory_clear –æ—á–∏—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç
- —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ DOCX/XLSX —Ñ–∞–π–ª—ã

## 16.2 v1 (2‚Äì4 –Ω–µ–¥–µ–ª–∏)
–¶–µ–ª—å: –∫–∞—á–µ—Å—Ç–≤–æ –∏ —É–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å.
- OCR –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- –°–∂–∞—Ç–∏–µ/–≤—ã–±–æ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ extracted_text
- –†—É—á–Ω–æ–π override –ø–æ –∫–Ω–æ–ø–∫–∞–º
- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ confidence –ø–æ –ª–æ–≥–∞–º
- –£–ª—É—á—à–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ DOCX/XLSX (—Å—Ç–∏–ª–∏, –º–µ—Ç–∞, ‚Äú—á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å‚Äù)

Acceptance:
- override < 15%
- extract fail < 7% (—Å OCR –ª—É—á—à–µ)
- —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —Ñ–∞–π–ª–æ–≤

## 16.3 v2 (4‚Äì8 –Ω–µ–¥–µ–ª—å)
–¶–µ–ª—å: –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ–¥.
- whitelist + —Ä–æ–ª–∏ + –∞–¥–º–∏–Ω–∫–∞
- –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (–µ—Å–ª–∏ –Ω–∞–¥–æ), –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∞–ø–¥–µ–π—Ç–æ–≤
- —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ (–ø–æ –≤–∞—à–∏–º –ø—Ä–∞–≤–∏–ª–∞–º)
- –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ/—ç–∫—Å–ø–æ—Ä—Ç –∫–µ–π—Å–∞
- –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (–º–µ—Ç—Ä–∏–∫–∏/–∞–ª–µ—Ä—Ç—ã)

Acceptance:
- SLA –ø–æ –∑–∞–¥–µ—Ä–∂–∫–∞–º
- –∞—É–¥–∏—Ç –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–∞–Ω–∏–∏
- –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –∏ —ç–∫—Å–ø–æ—Ä—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
